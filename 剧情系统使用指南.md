# 剧情系统使用指南

## 系统概述
本剧情系统采用状态转移树设计，通过节点和分支实现复杂的剧情流程。系统支持以下功能：
- 多分支剧情选择
- 基于条件的剧情触发
- 地图位置触发剧情
- NPC交互触发剧情
- 简单的文本显示和选项选择界面

## 文件结构
- `StorySystem.h`: 定义剧情系统的核心类和接口
- `StorySystem.cpp`: 实现剧情系统的功能和初始化
- `MainShell.h`: 集成剧情系统到游戏主界面
- `main.cpp`: 初始化和启动剧情系统

## 使用方法

### 1. 初始化剧情系统
在游戏启动时，调用`InitStorySystem()`函数初始化剧情系统：
```cpp
// 在main.cpp中
InitStorySystem();
```

### 2. 启动剧情
使用`StartGameStory()`函数启动初始剧情，或使用`g_storySystem.startStory(nodeId)`启动指定节点的剧情：
```cpp
// 启动初始剧情
StartGameStory();

// 或启动指定节点的剧情
// g_storySystem.startStory(5);
```

### 3. 添加新剧情节点
在`StorySystem.cpp`的`InitStorySystem()`函数中添加新的剧情节点：
```cpp
// 创建新节点
StoryNode newNode(6, "这是一个新的剧情节点。");

// 添加选项
newNode.addChoice("选项1", 7);
newNode.addChoice("选项2", 8);

// 设置触发条件
newNode.setCondition([](const Person& player) {
    // 只有当玩家等级大于10时才触发
    return player.GetLevel() > 10;
});

// 添加到剧情系统
g_storySystem.addNode(newNode);
```

```
###新增剧情选项的扩展系统###
```
//通过Set_Selection_Detection_Handler可以设置剧情点检验函数
//通过Set_choice_handel可以设置选项的触发后效果函数
//实例
 node1.GetChoice(1).Set_choice_handel([](){
     player.ChangeHP(12);
 })
```
